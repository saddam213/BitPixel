@model DotMatrix.Common.Deposits.DepositsModel
@{
	ViewBag.Title = "Deposits";
}

<div class="row">
	<div class="col-md-12">
		<h3>Balance: <span class="text-@(Model.Balance > 0 ? "success" : "")">@Model.Balance.ToString("F8")</span></h3>
		<div class="address-container">
			@if (string.IsNullOrEmpty(Model.Address))
			{
			<h3>Address: <button id="generate-address" class="btn btn-info btn-sm">Generate Address</button></h3>
			}
			else
			{
			<h3>Address: @Model.Address</h3>
			}
		</div>
	</div>
	<div class="col-md-12">
		<h2>Deposits <small style="font-size:10px"><i>(Last 50)</i></small></h2>
		<table class="table table-striped table-condensed">
			<thead>
				<tr>
					<th>Id</th>
					<th>Amount</th>
					<th>Status</th>
					<th>Confirms</th>
					<th>TxId</th>
					<th>Timestamp</th>
				</tr>
			</thead>
			<tbody>
				@if (Model.Deposits.Any())
				{
					
					foreach (var item in Model.Deposits)
					{
					<tr>
						<td>@item.Id</td>
						<td>@item.Amount.ToString("F8")</td>
						<td>@item.Status</td>
						<td>@item.Confirmations</td>
						<td>@item.TxId</td>
						<td>@item.Timestamp</td>
					</tr>
					}
				}
				else
				{
				<tr>
					<th colspan="6">You have no Dotcoin deposits.</th>
				</tr>
				}
			</tbody>
		</table>
	</div>
</div>
<hr />
<footer>
	<p>&copy; @DateTime.Now.Year - My Cryptopia Application</p>
</footer>
@section Scripts {
	<script>
		$("#generate-address").on("click", function () {
			var _this = $(this);
			_this.attr("disabled", "disabled");
			postJson('@Url.Action("GenerateAddress")', {}, function (data) {
				_this.removeAttr("disabled");
				if (data.Success) {
					$(".address-container").html("<h3>Address: " + data.Address + "</h3>");
				} else {
				alert("error")
				}
			});
		});
	
	</script>
}